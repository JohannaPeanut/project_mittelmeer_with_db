"use strict";

var _prngProxy = _interopRequireDefault(require("../../prng/prngProxy"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/**
 * Helper for randomBitString
 * Using Binomial-Shuffle algorithm
 * https://arxiv.org/pdf/1808.05009.pdf
 * Created by Alexey S. Kiselev
 */
module.exports = function (length) {
  var p = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.5;
  var binomialM = arguments.length > 2 ? arguments[2] : undefined;

  if (p === 1) {
    var _res = '';

    for (var i = 0; i < length; i += 1) {
      _res += '1';
    }

    return _res;
  }

  var res = [];

  for (var _i = 0; _i < length; _i += 1) {
    res[_i] = 0;
  }

  var k, t;

  for (var _i2 = length - binomialM; _i2 < length; _i2 += 1) {
    k = Math.floor(_prngProxy["default"].next() * _i2);
    t = length - 1 - k;

    if (res[t] === 0) {
      res[t] = 1;
    } else {
      res[length - 1 - _i2] = 1;
    }
  }

  return res.join('');
};